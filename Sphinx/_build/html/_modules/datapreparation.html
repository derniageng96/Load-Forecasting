

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>datapreparation &mdash; AAEON 2021 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AAEON
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AAEON</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>datapreparation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for datapreparation</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;# Import Library</span>
<span class="sd">## Use Plotly is optional, Plotly chose because we can filter the data to be shown</span>
<span class="sd">### You can use Matplotlib as well</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
<span class="kn">import</span> <span class="nn">chart_studio</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">chart_studio</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">set_credentials_file</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;DerniAgeng&#39;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;ZMAguW1HDlV8v7EYvqVJ&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> 
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">md</span>

<span class="sd">&quot;&quot;&quot;Data Exploratory</span>
<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Preprocessing"><a class="viewcode-back" href="../rst/datapreparation.html#datapreparation.Preprocessing">[docs]</a><span class="k">class</span> <span class="nc">Preprocessing</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocessing contains 4 functions</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        tr (dataframe) : data preprocessing for training building</span>
<span class="sd">        chang (dataframe) : data preprocessing for changyuan building</span>
<span class="sd">        mt (dataframe) : data preprocessing for maintenance building</span>
<span class="sd">        analysis (dataframe) : data analysis for selected dataframe</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Preprocessing.tr"><a class="viewcode-back" href="../rst/datapreparation.html#datapreparation.Preprocessing.tr">[docs]</a>    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        preprocessing for training building data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">            data (dataframe) : training building dataset</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            combine (dataframe) : processed dataset</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">missing_value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">missing_value</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Missing Percentage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">.30</span><span class="p">]</span>

        <span class="n">tr1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003304511002487000001&#39;</span><span class="p">])]</span>
        <span class="n">tr2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003304511002487000002&#39;</span><span class="p">])]</span>
        <span class="n">tr3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003304511002487000003&#39;</span><span class="p">])]</span>
        <span class="n">tr4</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003304511002487000004&#39;</span><span class="p">])]</span>
        <span class="n">tr5</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003304511002487000005&#39;</span><span class="p">])]</span>
        <span class="n">tr1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">vars_num_anom</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">tr1</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
        <span class="n">tr2</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">tr1</span><span class="o">.</span><span class="n">columns</span>

        <span class="n">tr1</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr1</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">tr2</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr2</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">tr3</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr3</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">tr4</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr4</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">tr5</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr5</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>

        <span class="n">tr1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;TR1_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">tr2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;TR2_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">tr3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;TR3_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">tr4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;TR4_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">tr5</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;TR5_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        
        <span class="sd">&quot;&quot;&quot;# Data Imputation</span>
<span class="sd">        </span>
<span class="sd">        ## Interpolation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tr1</span><span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr2</span><span class="o">=</span> <span class="n">tr2</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr3</span><span class="o">=</span> <span class="n">tr3</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr4</span><span class="o">=</span> <span class="n">tr4</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr5</span><span class="o">=</span> <span class="n">tr5</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;# Resample each EQID in Training Building&quot;&quot;&quot;</span>

        <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tr1</span> <span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">tr1</span> <span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tr2</span> <span class="o">=</span> <span class="n">tr2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">tr2</span> <span class="o">=</span> <span class="n">tr2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr3</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tr3</span> <span class="o">=</span> <span class="n">tr3</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">tr3</span> <span class="o">=</span> <span class="n">tr3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr4</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tr4</span> <span class="o">=</span> <span class="n">tr4</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">tr4</span> <span class="o">=</span> <span class="n">tr4</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr5</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tr5</span> <span class="o">=</span> <span class="n">tr5</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">tr5</span> <span class="o">=</span> <span class="n">tr5</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="c1"># fill the missing values again if there is still &#39;NaN&#39; value</span>
        <span class="n">tr1</span><span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr2</span><span class="o">=</span> <span class="n">tr2</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr3</span><span class="o">=</span> <span class="n">tr3</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr4</span><span class="o">=</span> <span class="n">tr4</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">tr5</span><span class="o">=</span> <span class="n">tr5</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;Since there is big gap in the first part of dataset we only chose this range of dataset&quot;&quot;&quot;</span>

        <span class="n">tr1</span> <span class="o">=</span> <span class="n">tr1</span><span class="p">[</span><span class="mi">900</span><span class="p">:</span><span class="mi">4080</span><span class="p">]</span>
        <span class="n">tr2</span> <span class="o">=</span> <span class="n">tr2</span><span class="p">[</span><span class="mi">900</span><span class="p">:</span><span class="mi">4080</span><span class="p">]</span>
        <span class="n">tr3</span> <span class="o">=</span> <span class="n">tr3</span><span class="p">[</span><span class="mi">900</span><span class="p">:</span><span class="mi">4080</span><span class="p">]</span>
        <span class="n">tr4</span> <span class="o">=</span> <span class="n">tr4</span><span class="p">[</span><span class="mi">900</span><span class="p">:</span><span class="mi">4080</span><span class="p">]</span>
        <span class="n">tr5</span> <span class="o">=</span> <span class="n">tr5</span><span class="p">[</span><span class="mi">900</span><span class="p">:</span><span class="mi">4080</span><span class="p">]</span>

        <span class="sd">&quot;&quot;&quot;# Feature Engineering</span>

<span class="sd">        ## Create Addition Feature</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr1</span> <span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr2</span> <span class="o">=</span> <span class="n">tr2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr3</span> <span class="o">=</span> <span class="n">tr3</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr4</span> <span class="o">=</span> <span class="n">tr4</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">tr5</span> <span class="o">=</span> <span class="n">tr5</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>

        <span class="n">tr1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>

        <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>

        <span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">tr1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">tr2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">tr3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">tr4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">tr5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;## Merge with Temperature&quot;&quot;&quot;</span>

        <span class="n">d_two</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Taipei_temperature_202007-202104.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

        <span class="n">d_two</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">d_two</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">d_two</span> <span class="o">=</span> <span class="n">d_two</span><span class="p">[[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;lastReportTime&#39;</span><span class="p">]]</span>

        <span class="n">d_two</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">d_two</span> <span class="o">=</span> <span class="n">d_two</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">d_two</span> <span class="o">=</span> <span class="n">d_two</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">d_two</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">trid1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">trid2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tr2</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">trid3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tr3</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">trid4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tr4</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">trid5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tr5</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>

        <span class="n">trid2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">trid1</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003304511002487000001&#39;</span>
        <span class="n">trid2</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003304511002487000002&#39;</span>
        <span class="n">trid3</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003304511002487000003&#39;</span>
        <span class="n">trid4</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003304511002487000004&#39;</span>
        <span class="n">trid5</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003304511002487000005&#39;</span>

        <span class="sd">&quot;&quot;&quot;# Combine every EQID&quot;&quot;&quot;</span>

        <span class="n">combine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">trid1</span><span class="p">,</span><span class="n">trid2</span><span class="p">,</span><span class="n">trid3</span><span class="p">,</span><span class="n">trid4</span><span class="p">,</span><span class="n">trid5</span><span class="p">])</span>
        <span class="n">combine</span>

        <span class="n">combine</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">combine</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">combine</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;trainingbuilding_interpolation_202007-202104&#39;</span><span class="p">)</span>
        <span class="n">combine</span></div>

<div class="viewcode-block" id="Preprocessing.chang"><a class="viewcode-back" href="../rst/datapreparation.html#datapreparation.Preprocessing.chang">[docs]</a>    <span class="k">def</span> <span class="nf">chang</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        preprocessing for changyuan building data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">            data (dataframe) : changyuan dataset</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            combine (dataframe) : processed dataset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="sd">&quot;&quot;&quot;## Select EQID from Changyuan building&quot;&quot;&quot;</span>

        <span class="n">changyuan</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003f4e11ed5c10c000002&#39;</span><span class="p">])]</span>
        <span class="n">changyuan</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;## Separate Numerical Column&quot;&quot;&quot;</span>

        <span class="n">vars_num_anom</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">changyuan</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
        <span class="n">changyuan</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;## Check Missing Percentage&quot;&quot;&quot;</span>

        <span class="n">missing_value</span> <span class="o">=</span> <span class="n">changyuan</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">missing_value</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Missing Percentage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;## Replace the wrong value to &#39;NaN&#39;&quot;&quot;&quot;</span>

        <span class="n">changyuan</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>

        <span class="sd">&quot;&quot;&quot;## Drop the column that has missing percentage greater than 30%&quot;&quot;&quot;</span>

        <span class="n">changyuan</span> <span class="o">=</span> <span class="n">changyuan</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">changyuan</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">.30</span><span class="p">]</span>
        <span class="n">changyuan</span><span class="o">.</span><span class="n">columns</span>

        <span class="sd">&quot;&quot;&quot;Check Missing percentage of each ID&quot;&quot;&quot;</span>

        <span class="n">c1</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">])]</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;2&#39;</span><span class="p">])]</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;3&#39;</span><span class="p">])]</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;4&#39;</span><span class="p">])]</span>
        <span class="n">c5</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;5&#39;</span><span class="p">])]</span>
        <span class="n">c6</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;6&#39;</span><span class="p">])]</span>
        <span class="n">c7</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;7&#39;</span><span class="p">])]</span>
        <span class="n">c8</span> <span class="o">=</span> <span class="n">changyuan</span><span class="p">[</span><span class="n">changyuan</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;8&#39;</span><span class="p">])]</span>

        <span class="n">c1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C1_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C2_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C3_withnan_202007-202104.csv&#39;</span><span class="p">)</span>    
        <span class="n">c4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C4_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c5</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C5_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c6</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C6_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c7</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C7_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c8</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C8_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
    
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">c3</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">c4</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c5</span> <span class="o">=</span> <span class="n">c5</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c6</span> <span class="o">=</span> <span class="n">c6</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c7</span> <span class="o">=</span> <span class="n">c7</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">c8</span> <span class="o">=</span> <span class="n">c8</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;# Resample each block&quot;&quot;&quot;</span>

        <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c3</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">c3</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">c3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c4</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">c4</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">c4</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c5</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c5</span> <span class="o">=</span> <span class="n">c5</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c5</span> <span class="o">=</span> <span class="n">c5</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c6</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c6</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c6</span> <span class="o">=</span> <span class="n">c6</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c6</span> <span class="o">=</span> <span class="n">c6</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c7</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c7</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c7</span> <span class="o">=</span> <span class="n">c7</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c7</span> <span class="o">=</span> <span class="n">c7</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c8</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c8</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">c8</span> <span class="o">=</span> <span class="n">c8</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">c8</span> <span class="o">=</span> <span class="n">c8</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">c1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C1_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C2_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C3_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C4_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c5</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C5_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c6</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C6_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c7</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C7_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">c8</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C8_202007-202104.csv&#39;</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;# Feature Engineering</span>
<span class="sd">        ## Create Additional Feature</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">c3</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">c4</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c5</span> <span class="o">=</span> <span class="n">c5</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c6</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c6</span> <span class="o">=</span> <span class="n">c6</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c6</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c7</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c7</span> <span class="o">=</span> <span class="n">c7</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c7</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">c8</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">c8</span> <span class="o">=</span> <span class="n">c8</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">c8</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>

        <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>

        <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>

        <span class="n">c1</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c2</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c3</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c4</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c5</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c6</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c6</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c7</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c7</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c8</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">c8</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;# Merge with Temperature Dataset&quot;&quot;&quot;</span>

        <span class="n">d_two</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Taipei_temperature_202007-202104.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

        <span class="n">d_two</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">d_two</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">d_two</span> <span class="o">=</span> <span class="n">d_two</span><span class="p">[[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;lastReportTime&#39;</span><span class="p">]]</span>

        <span class="n">cid1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c4</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c5</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c6</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c7</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c8</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">cid1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;# Combine every ID&quot;&quot;&quot;</span>

        <span class="n">combine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cid1</span><span class="p">,</span><span class="n">cid2</span><span class="p">,</span><span class="n">cid3</span><span class="p">,</span><span class="n">cid4</span><span class="p">,</span><span class="n">cid5</span><span class="p">,</span><span class="n">cid6</span><span class="p">,</span><span class="n">cid7</span><span class="p">,</span><span class="n">cid8</span><span class="p">])</span>
        <span class="n">combine</span>

        <span class="n">combine</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">combine</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;changyuanbuilding(202007-202104)_interpolation.csv&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">combine</span></div>
        
<div class="viewcode-block" id="Preprocessing.mt"><a class="viewcode-back" href="../rst/datapreparation.html#datapreparation.Preprocessing.mt">[docs]</a>    <span class="k">def</span> <span class="nf">mt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        preprocessing for maintenance building data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">            data (dataframe) : maintenance dataset</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            combine (dataframe) : processed dataset</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="sd">&quot;&quot;&quot;Check missing percentage&quot;&quot;&quot;</span>

        <span class="n">missing_value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">missing_value</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Missing Percentage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;Drop Column that has missing percentage greater than 35%&quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">.35</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ae_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ae_tot&#39;</span><span class="p">])</span>

        <span class="sd">&quot;&quot;&quot;Separate each ID to different dataframe&quot;&quot;&quot;</span>

        <span class="n">mt1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003f4e11edd022d000001&#39;</span><span class="p">])]</span>
        <span class="n">mt2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003f4e11edd022d000002&#39;</span><span class="p">])]</span>
        <span class="n">mt3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003f4e11edd022d000003&#39;</span><span class="p">])]</span>
        <span class="n">mt4</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003f4e11edd022d000004&#39;</span><span class="p">])]</span>
        <span class="n">mt5</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;001003f4e11edd022d000005&#39;</span><span class="p">])]</span>
        <span class="n">mt1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;blockId&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>


        <span class="sd">&quot;&quot;&quot;Convert &#39;LastReportTime&#39; column as datetime&quot;&quot;&quot;</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># mt1 = mt1.resample(&#39;h&#39;).mean()</span>
        <span class="n">mt1</span> <span class="o">=</span> <span class="n">mt1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># mt2 = mt2.resample(&#39;h&#39;).mean()</span>
        <span class="n">mt2</span> <span class="o">=</span> <span class="n">mt2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt3</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># mt3 = mt3.resample(&#39;h&#39;).mean()</span>
        <span class="n">mt3</span> <span class="o">=</span> <span class="n">mt3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt4</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># mt4 = mt4.resample(&#39;h&#39;).mean()</span>
        <span class="n">mt4</span> <span class="o">=</span> <span class="n">mt4</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt5</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># mt5 = mt5.resample(&#39;h&#39;).mean()</span>
        <span class="n">mt5</span> <span class="o">=</span> <span class="n">mt5</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;Handle the Wrong Value</span>
<span class="sd">        We observed the load data in particular time, and found that overflow value sent to the database(2^31)</span>

<span class="sd">        Reference : [Overflow](https://microchipdeveloper.com/dsp0201:overflow-and-saturation)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="sd">&quot;&quot;&quot;Separate numerical column on dataset&quot;&quot;&quot;</span>

        <span class="n">vars_num_anom</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">mt1</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
        <span class="n">mt2</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">mt1</span><span class="o">.</span><span class="n">columns</span>

        <span class="sd">&quot;&quot;&quot;Replace the wrong value with NaN&quot;&quot;&quot;</span>

        <span class="n">mt1</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt1</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">mt2</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt2</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">mt3</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt3</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">mt4</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt4</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>
        <span class="n">mt5</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt5</span><span class="p">[</span><span class="n">vars_num_anom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2147483647</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">})</span>

        <span class="n">mt5</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>

        <span class="n">mt1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT1_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">mt2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT2_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">mt3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT3_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">mt4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT4_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">mt5</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT5_withnan_202007-202104.csv&#39;</span><span class="p">)</span>
        
        <span class="sd">&quot;&quot;&quot;Interpolation&quot;&quot;&quot;</span>
        <span class="n">mt1</span><span class="o">=</span> <span class="n">mt1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">mt2</span><span class="o">=</span> <span class="n">mt2</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">mt3</span><span class="o">=</span> <span class="n">mt3</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">mt4</span><span class="o">=</span> <span class="n">mt4</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">mt5</span><span class="o">=</span> <span class="n">mt5</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
        <span class="n">mt2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="sd">&quot;&quot;&quot;Resample each EQID in Maintenance Building&quot;&quot;&quot;</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mt1</span> <span class="o">=</span> <span class="n">mt1</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mt1</span> <span class="o">=</span> <span class="n">mt1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mt2</span> <span class="o">=</span> <span class="n">mt2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mt2</span> <span class="o">=</span> <span class="n">mt2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt3</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mt3</span> <span class="o">=</span> <span class="n">mt3</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mt3</span> <span class="o">=</span> <span class="n">mt3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt4</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mt4</span> <span class="o">=</span> <span class="n">mt4</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mt4</span> <span class="o">=</span> <span class="n">mt4</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt5</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mt5</span> <span class="o">=</span> <span class="n">mt5</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mt5</span> <span class="o">=</span> <span class="n">mt5</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003f4e11edd022d000001&#39;</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003f4e11edd022d000002&#39;</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003f4e11edd022d000003&#39;</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003f4e11edd022d000004&#39;</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;equipmentId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;001003f4e11edd022d000005&#39;</span>

        <span class="n">mt1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">mt1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT1(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT2(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT3(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT4(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt5</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MT5(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;# Feature Engineering</span>
<span class="sd">        ## Create Additional Feature (Session Time, Weekend/Weekday indicator)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt1</span> <span class="o">=</span> <span class="n">mt1</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt2</span> <span class="o">=</span> <span class="n">mt2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt3</span> <span class="o">=</span> <span class="n">mt3</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt4</span> <span class="o">=</span> <span class="n">mt4</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">mt5</span> <span class="o">=</span> <span class="n">mt5</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">]))</span>

        <span class="n">mt1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Midnight&#39;</span><span class="p">)</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Night&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Morning&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>

        <span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;Merge with Temperature&quot;&quot;&quot;</span>

        <span class="n">d_two</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Taipei_temperature_202007-202104.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

        <span class="n">d_two</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">d_two</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">d_two</span> <span class="o">=</span> <span class="n">d_two</span><span class="p">[[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;lastReportTime&#39;</span><span class="p">]]</span>

        <span class="n">mtid1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mt1</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">mtid2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mt2</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">mtid3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mt3</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">mtid4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mt4</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>
        <span class="n">mtid5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mt5</span><span class="p">,</span> <span class="n">d_two</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">)</span>

        <span class="n">mtid1</span>

        <span class="sd">&quot;&quot;&quot;Combine every EQID&quot;&quot;&quot;</span>

        <span class="n">combine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mtid1</span><span class="p">,</span><span class="n">mtid2</span><span class="p">,</span><span class="n">mtid3</span><span class="p">,</span><span class="n">mtid4</span><span class="p">,</span><span class="n">mtid5</span><span class="p">])</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">combine</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">combine</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">combine</span> <span class="o">=</span> <span class="n">combine</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="n">combine</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;mtbuilding_cleanedwithinterpolation_202007-202104.csv&#39;</span><span class="p">)</span>
        <span class="n">combine</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">combine</span></div>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Data Analysis</span>
<span class="sd">        Pattern on Dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Preprocessing.analysis"><a class="viewcode-back" href="../rst/datapreparation.html#datapreparation.Preprocessing.analysis">[docs]</a>    <span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analysis load data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">            data (dataframe) : load data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># data = pd.read_csv(&#39;mtbuilding_cleanedwithinterpolation_202007-202104.csv&#39;)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">xfmt</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">25</span> <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">][:</span><span class="mi">14</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">][:</span><span class="mi">14</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Load Consumption on Weekend and Holiday&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load(W)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xfmt</span><span class="p">)</span>
        <span class="c1"># plt.label(loc = &#39;upper right&#39;)</span>
        <span class="c1"># plt.title(&#39;Load - Processed Data&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># data = pd.read_csv(&#39;mtbuilding_cleanedwithinterpolation_202007-202104.csv&#39;)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">720</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">pagi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;2&#39;</span><span class="p">])]</span>
        <span class="n">siang</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;3&#39;</span><span class="p">])]</span>
        <span class="n">malem</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;0&#39;</span><span class="p">])]</span>
        <span class="n">midnight</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">])]</span>
        <span class="n">sore</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;4&#39;</span><span class="p">])]</span>

        <span class="c1"># pagi.head()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Distribution of Load Consumption in Different Session Time&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">pagi</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span><span class="n">siang</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span><span class="n">sore</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span><span class="n">malem</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span><span class="n">midnight</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Morning&#39;</span><span class="p">,</span><span class="s1">&#39;Afternoon&#39;</span><span class="p">,</span><span class="s1">&#39;Evening&#39;</span><span class="p">,</span><span class="s1">&#39;Night&#39;</span><span class="p">,</span><span class="s1">&#39;Midnight&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Load Consumption&#39;</span><span class="p">)</span>

        <span class="n">mt1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;MT1(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;MT2(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;MT3(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;MT4(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        <span class="n">mt5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;MT5(2020_07-2021_04)_interpolation.csv&#39;</span><span class="p">)</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;MT1&#39;</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">mt2</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;MT2&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">mt3</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MT3&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">mt4</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MT4&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">mt5</span><span class="p">[</span><span class="s1">&#39;p_sum&#39;</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span><span class="n">mt1</span><span class="p">[</span><span class="s1">&#39;lastReportTime&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MT5&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s1">&#39;Power Consumption&#39;</span><span class="p">)</span>
        <span class="n">pio</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="main"><a class="viewcode-back" href="../rst/datapreparation.html#datapreparation.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;hotaiLog_2020_07-08.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;hotaiLog_2020_0901-1025.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
    <span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hotaiLog_2020_1026-1217.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hotaiLog_20201218-20210131.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hotaiLog_20210201-20210315.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hotaiLog_20210316-20210428.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">df3</span><span class="p">,</span><span class="n">df4</span><span class="p">,</span><span class="n">df5</span><span class="p">,</span><span class="n">df6</span><span class="p">])</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

    <span class="n">pre</span> <span class="o">=</span> <span class="n">Preprocessing</span><span class="p">()</span>
    <span class="n">mt</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="n">mt</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">mt</span> 
    <span class="n">ch</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="n">chang</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">ch</span>
    <span class="n">dataana</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;mtbuilding_cleanedwithinterpolation_202007-202104.csv&#39;</span><span class="p">)</span>
    <span class="n">ana</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="n">analysis</span><span class="p">(</span><span class="n">dataana</span><span class="p">)</span>
    <span class="n">ana</span></div>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Derni

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>